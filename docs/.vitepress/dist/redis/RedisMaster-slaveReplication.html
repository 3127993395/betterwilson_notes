<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Redis集群-主从复制 | BetterWilson Notes</title>
    <meta name="description" content="Notes from BetterWilson">
    <meta name="generator" content="VitePress v1.2.2">
    <link rel="preload stylesheet" href="/assets/style.BoVWarxu.css" as="style">
    
    <script type="module" src="/assets/app.BAmfaRzz.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/framework.D5qxx6u8.js">
    <link rel="modulepreload" href="/assets/chunks/theme.i3bxP0fg.js">
    <link rel="modulepreload" href="/assets/redis_RedisMaster-slaveReplication.md.BepGyD_Q.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-5d98c3a5><!--[--><!--]--><!--[--><span tabindex="-1" data-v-0f60ec36></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-0f60ec36> Skip to content </a><!--]--><!----><header class="VPNav" data-v-5d98c3a5 data-v-ae24b3ad><div class="VPNavBar has-sidebar top" data-v-ae24b3ad data-v-ccf7ddec><div class="wrapper" data-v-ccf7ddec><div class="container" data-v-ccf7ddec><div class="title" data-v-ccf7ddec><div class="VPNavBarTitle has-sidebar" data-v-ccf7ddec data-v-ab179fa1><a class="title" href="/" data-v-ab179fa1><!--[--><!--]--><!--[--><img class="VPImage logo" src="logo.png" alt data-v-8426fc1a><!--]--><span data-v-ab179fa1>BetterWilson Notes</span><!--[--><!--]--></a></div></div><div class="content" data-v-ccf7ddec><div class="content-body" data-v-ccf7ddec><!--[--><!--]--><div class="VPNavBarSearch search" data-v-ccf7ddec><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-ccf7ddec data-v-7f418b0f><span id="main-nav-aria-label" class="visually-hidden" data-v-7f418b0f>Main Navigation</span><!--[--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-7f418b0f data-v-b6c34ac9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-b6c34ac9><span class="text" data-v-b6c34ac9><!----><span data-v-b6c34ac9>Python</span><span class="vpi-chevron-down text-icon" data-v-b6c34ac9></span></span></button><div class="menu" data-v-b6c34ac9><div class="VPMenu" data-v-b6c34ac9 data-v-e7ea1737><div class="items" data-v-e7ea1737><!--[--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/python/ConcurrentProgramming/" data-v-43f1e123><!--[-->python并发编程<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/python/ObjectOriented/" data-v-43f1e123><!--[-->python面向对象<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/python/supplement/" data-v-43f1e123><!--[-->python补充<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/git/" tabindex="0" data-v-7f418b0f data-v-9c663999><!--[--><span data-v-9c663999>Git</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/django/" tabindex="0" data-v-7f418b0f data-v-9c663999><!--[--><span data-v-9c663999>Django</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/drf/" tabindex="0" data-v-7f418b0f data-v-9c663999><!--[--><span data-v-9c663999>DRF</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/gin/" tabindex="0" data-v-7f418b0f data-v-9c663999><!--[--><span data-v-9c663999>Gin</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/vue/" tabindex="0" data-v-7f418b0f data-v-9c663999><!--[--><span data-v-9c663999>Vue</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/redis/" tabindex="0" data-v-7f418b0f data-v-9c663999><!--[--><span data-v-9c663999>Redis</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/linux/" tabindex="0" data-v-7f418b0f data-v-9c663999><!--[--><span data-v-9c663999>Linux</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/hadoop/" tabindex="0" data-v-7f418b0f data-v-9c663999><!--[--><span data-v-9c663999>hadoop</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-ccf7ddec data-v-e6aabb21><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-e6aabb21 data-v-d1f28634 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-d1f28634></span><span class="vpi-moon moon" data-v-d1f28634></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-ccf7ddec data-v-0394ad82 data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://github.com/3127993395/Notes" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-eee4e7cb><span class="vpi-social-github" /></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-ccf7ddec data-v-d0bd9dde data-v-b6c34ac9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-b6c34ac9><span class="vpi-more-horizontal icon" data-v-b6c34ac9></span></button><div class="menu" data-v-b6c34ac9><div class="VPMenu" data-v-b6c34ac9 data-v-e7ea1737><!----><!--[--><!--[--><!----><div class="group" data-v-d0bd9dde><div class="item appearance" data-v-d0bd9dde><p class="label" data-v-d0bd9dde>Appearance</p><div class="appearance-action" data-v-d0bd9dde><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-d0bd9dde data-v-d1f28634 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-d1f28634></span><span class="vpi-moon moon" data-v-d1f28634></span><!--]--></span></span></button></div></div></div><div class="group" data-v-d0bd9dde><div class="item social-links" data-v-d0bd9dde><div class="VPSocialLinks social-links-list" data-v-d0bd9dde data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://github.com/3127993395/Notes" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-eee4e7cb><span class="vpi-social-github" /></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-ccf7ddec data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><div class="divider" data-v-ccf7ddec><div class="divider-line" data-v-ccf7ddec></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-5d98c3a5 data-v-a6f0e41e><div class="container" data-v-a6f0e41e><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-a6f0e41e><span class="vpi-align-left menu-icon" data-v-a6f0e41e></span><span class="menu-text" data-v-a6f0e41e>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-a6f0e41e data-v-17a5e62e><button data-v-17a5e62e>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-5d98c3a5 data-v-575e6a36><div class="curtain" data-v-575e6a36></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-575e6a36><span class="visually-hidden" id="sidebar-aria-label" data-v-575e6a36> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-575e6a36><section class="VPSidebarItem level-0 has-active" data-v-575e6a36 data-v-b8d55f3b><!----><div class="items" data-v-b8d55f3b><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/redis/no-password.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>多台服务器无密码传输数据</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/redis/Django-redis.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Django连接redis</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/redis/Python-redis.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Python连接redis</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/redis/PythonRedisCluster.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Python连接Redis集群</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/redis/PythonRedisSentinel.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Python连接Redis哨兵</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/redis/redisPersistence.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>redis持久化</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/redis/RedisKey.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Redis大key热key过期key</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/redis/RedisCluster.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Redis集群Cluster</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/redis/RedisSentinel.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Redis哨兵Sentinel</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/redis/RedisDataType.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Redis数据类型</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/redis/RedisMaster-slaveReplication.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Redis主从复制</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-5d98c3a5 data-v-1428d186><div class="VPDoc has-sidebar has-aside" data-v-1428d186 data-v-39a288b8><!--[--><!--]--><div class="container" data-v-39a288b8><div class="aside" data-v-39a288b8><div class="aside-curtain" data-v-39a288b8></div><div class="aside-container" data-v-39a288b8><div class="aside-content" data-v-39a288b8><div class="VPDocAside" data-v-39a288b8 data-v-3f215769><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-3f215769 data-v-a5bbad30><div class="content" data-v-a5bbad30><div class="outline-marker" data-v-a5bbad30></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-a5bbad30>On this page</div><ul class="VPDocOutlineItem root" data-v-a5bbad30 data-v-b933a997><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-39a288b8><div class="content-container" data-v-39a288b8><!--[--><!--]--><main class="main" data-v-39a288b8><div style="position:relative;" class="vp-doc _redis_RedisMaster-slaveReplication" data-v-39a288b8><div><h1 id="redis集群-主从复制" tabindex="-1">Redis集群-主从复制 <a class="header-anchor" href="#redis集群-主从复制" aria-label="Permalink to &quot;Redis集群-主从复制&quot;">​</a></h1><p><strong>主库负责写，从库负责读，主从库始终保持数据一致性</strong></p><h2 id="实验" tabindex="-1">实验 <a class="header-anchor" href="#实验" aria-label="Permalink to &quot;实验&quot;">​</a></h2><p>从库可以配置多台，比如一主一从，一主多从，并且所有从库配置主库都是一条命令搞定。</p><p>此时我的服务器：</p><ul><li>db01，主节点，192.168.10.150</li><li>db02，从节点，192.168.10.151</li></ul><h4 id="在db01创建一些key" tabindex="-1"><strong>在db01创建一些key</strong> <a class="header-anchor" href="#在db01创建一些key" aria-label="Permalink to &quot;**在db01创建一些key**&quot;">​</a></h4><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/null</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /opt/redis6379/logs/redis6379.log</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">du</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -sh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /opt/redis6379/logs/redis6379.log</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">1..10000}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">do</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> redis-cli</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> wilson</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$i $i;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $i;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">done</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">redis-cli</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bgsave</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">redis-cli</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dbsize</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@cs opt]# </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">1..10000}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">do</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> redis-cli</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> wilson</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$i $i;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $i;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">done</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@cs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]# redis-cli bgsave</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Background</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> saving</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> started</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@cs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]# redis-cli dbsize</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">integer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">10000</span></span></code></pre></div><h4 id="在redis02配置主从" tabindex="-1">在redis02配置主从 <a class="header-anchor" href="#在redis02配置主从" aria-label="Permalink to &quot;在redis02配置主从&quot;">​</a></h4><p>临时生效，就是直接执行SLAVEOF命令</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># SLAVEOF 主库IP 端口</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/null</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /opt/redis6379/logs/redis6379.log</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">du</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -sh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /opt/redis6379/logs/redis6379.log</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">redis-cli</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> flushall</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">redis-cli</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SLAVEOF</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 192.168.10.150</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 6379</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">redis-cli</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dbsize</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@cs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]# redis-cli flushall</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">OK</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@cs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]# redis-cli dbsize</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">integer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@cs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]# redis-cli SLAVEOF 192.168.10.150 6379</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">OK</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@cs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]# redis-cli dbsize</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">integer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">10000</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vim</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /opt/redis6379/conf/redis6379.conf</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SLAVEOF</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 192.168.10.144</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 6379</span></span></code></pre></div><p>永久生效就是写入到Redis配置文件中:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;SLAVEOF 192.168.43.128 6379&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /opt/redis6379/conf/redis6379.conf</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /opt/redis6379/conf/redis6379.conf</span></span></code></pre></div><p>其它命令：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 查看主从状态的各种信息</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">INFO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> REPLICATION</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 查看自己的角色</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ROLE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@cs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]# redis-cli INFO REPLICATION</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Replication</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">role:slave</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">master_host:192.168.10.150</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">master_port:6379</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">master_link_status:up</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">master_last_io_seconds_ago:1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">master_sync_in_progress:0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">slave_repl_offset:196</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">slave_priority:100</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">slave_read_only:1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">connected_slaves:0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">master_replid:1c2c8c97d3b3c4e4ba6fc1237b3742161f114cbc</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">master_replid2:0000000000000000000000000000000000000000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">master_repl_offset:196</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">second_repl_offset:-1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">repl_backlog_active:1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">repl_backlog_size:1048576</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">repl_backlog_first_byte_offset:1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">repl_backlog_histlen:196</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@cs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]# redis-cli ROLE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;slave&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;192.168.43.128&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">integer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) 6379</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;connected&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">integer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) 196</span></span></code></pre></div><h2 id="replication工作原理" tabindex="-1">Replication工作原理 <a class="header-anchor" href="#replication工作原理" aria-label="Permalink to &quot;Replication工作原理&quot;">​</a></h2><p>Redis Replication是一种简单、易用的主从模式（master-slave）的复制机制，它能够使得slave节点成为与master节点完全相同的副本。每次与master节点连接中断后slave节点会自动重联，并且无论master节点发生什么，slave节点总是尝试达到与master节点一致的状态。Redis采取了一系列的辅助措施来保证数据安全。</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Redis主从复制技术有两个版本：在2.8版本之前，每次slave节点断线重联后，只能进行全量同步。在2.8版本之后进行了重新设计，引入了部分同步的概念。本文将以Redis 5.0.7版本为基础对主从复制原理进行介绍。</span></span></code></pre></div><p>旧版主从复制采用的是“全量同步+命令传播”机制完成主从数据同步，这里的硬伤是从机重连后，哪怕主从之间只有少量的数据不一致，也要执行一个耗时、耗资源的全量同步操作来达到数据一致。为此，Redis团队引入了若干机制确保在少量数据不一致时，采用代价较低的部分同步来完成主从复制。所以，当前的主从复制机制包含三个部分：全量同步、部分同步、命令传播。</p><p>为保证内容完整性，还是先介绍一下全量同步、命令传播两个历史的概念。</p><ul><li>全量同步：master节点创建全量数据的RDB快照文件，通过网络连接发送给slave节点，slave节点加载快照文件恢复数据，然后再继续发送复制过程中复制积压缓冲区内新增的命令，使之达到数据一致状态。</li><li>命令传播：如果master-slave节点保持连接，master节点将持续向slave节点发送命令流，以保证master节点数据集发生的改变同样作用在slave节点数据集上，这些命令包含：客户端写请求、key过期、数据淘汰以及其他所有引起数据集变更的操作。</li></ul><h2 id="同步原理" tabindex="-1">同步原理 <a class="header-anchor" href="#同步原理" aria-label="Permalink to &quot;同步原理&quot;">​</a></h2><p>在主从复制模式下，Redis使用一对<code>Replicaion ID, offset</code>来唯一识别Master节点数据集的版本，要理解这个“版本“的概念需要认识Redis的以下三个概念：</p><ul><li>Replication ID（复制ID）：每个Redis的主节点都用一个随机生成的字符串来表示在某一时刻其内部存储数据的状态，“某一时刻”可以理解为其成为master角色的那一刻，由源码可知在第一个从节点加入时，Redis初始化了复制ID。</li><li>offset（复制偏移量）：主从模式下，主节点会持续不断的向从节点传播引起数据集更改的命令，offset所表示的是主节点向从节点传递命令字节总数。它不是孤立存在的，需要配合复制积压缓冲区才能工作。</li><li>backlog（复制积压缓冲区）：它是一个环形缓冲区，用来存储主节点向从节点传递的命令，它的大小是固定的，可存储的命令有限，超出部分将会被删除。它即可用于部分同步，也可用于命令传播阶段的命令重推。</li></ul><p><img src="/assets/image-20240316211322483.D8kiXl7F.png" alt="image-20240316211322483"></p><p>我们也能从日志来着手印证下，下面是我按照打印日志的时间顺序整理了下其过程(部分关键日志)</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">从库：</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 从库向主库发送主从同步请求</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">54340:S</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 03</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Aug</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2023</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 23:20:30.274</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> REPLICAOF</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 192.168.10.150:6379</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enabled</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (user </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">request</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;id=10 addr=127.0.0.1:33956 fd=7 name= age=0 idle=0 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=48 qbuf-free=32720 obl=0 oll=0 omem=0 events=r cmd=slaveof&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">主库：</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 主库接收到了主库的请求</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">21566:M</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 03</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Aug</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2023</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 15:20:30.667</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Replica</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 192.168.10.151:6379</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> asks</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> synchronization</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">21566:M</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 03</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Aug</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2023</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 15:20:30.667</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Partial</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> resynchronization</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> not</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> accepted:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Replication</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ID</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mismatch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (Replica </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">asked</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;6dd2fe7d7518ca1547f387d5158fd2015c9b39f5&#39;,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> my</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> replication</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> IDs</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> are</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;113f5106075b494c44df2ff79ac68e7044a6a59b&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> and</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;0000000000000000000000000000000000000000&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 主库立即执行bgsave，拍个最新的快照保存到本地并向从库发送rdb数据</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">21566:M</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 03</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Aug</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2023</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 15:20:30.667</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> BGSAVE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SYNC</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> with</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> target:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> disk</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">21566:M</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 03</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Aug</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2023</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 15:20:30.667</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Background</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> saving</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> started</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> by</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pid</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 42854</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">42854:C</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 03</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Aug</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2023</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 15:20:30.672</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DB</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> saved</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> on</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> disk</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">42854:C</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 03</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Aug</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2023</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 15:20:30.673</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> RDB:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MB</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> memory</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> used</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> by</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> copy-on-write</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">21566:M</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 03</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Aug</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2023</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 15:20:30.774</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Background</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> saving</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> terminated</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> with</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> success</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">21566:M</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 03</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Aug</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2023</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 15:20:30.779</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Synchronization</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> with</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> replica</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 192.168.10.151:6379</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> succeeded</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">从库：</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 从库接受主库发来的rdb数据</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">54340:S</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 03</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Aug</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2023</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 23:20:30.834</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Connecting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MASTER</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 192.168.10.150:6379</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">54340:S</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 03</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Aug</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2023</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 23:20:30.834</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MASTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> REPLICA</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sync</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> started</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">54340:S</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 03</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Aug</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2023</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 23:20:30.834</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Non</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> blocking</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> connect</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SYNC</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> fired</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> event.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">54340:S</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 03</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Aug</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2023</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 23:20:30.849</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Master</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> replied</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> PING,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> replication</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> can</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> continue...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">54340:S</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 03</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Aug</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2023</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 23:20:30.851</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Trying</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> partial</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> resynchronization</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (request </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">6dd2fe7d7518ca1547f387d5158fd2015c9b39f5:329</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">54340:S</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 03</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Aug</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2023</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 23:20:30.899</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Full</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> resync</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> master:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 113f5106075b494c44df2ff79ac68e7044a6a59b:835852</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">54340:S</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 03</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Aug</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2023</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 23:20:30.899</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Discarding</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> previously</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cached</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> master</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> state.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 接收到了来自主库的168951 bytes</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">54340:S</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 03</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Aug</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2023</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 23:20:31.004</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MASTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> REPLICA</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sync:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> receiving</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 168951</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bytes</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> master</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 重要动作：清空从库自己老的数据，然后加载主库同步过来的rdb数据到内存中</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">54340:S</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 03</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Aug</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2023</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 23:20:31.010</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MASTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> REPLICA</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sync:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Flushing</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> old</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> data</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">54340:S</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 03</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Aug</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2023</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 23:20:31.010</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MASTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> REPLICA</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sync:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Loading</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DB</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> memory</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">54340:S</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 03</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Aug</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2023</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 23:20:31.013</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MASTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> REPLICA</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sync:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Finished</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> with</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> success</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 上面已经同步成功了rdb数据，接下来就是同步aof了，执行aof重写机制处理aof文件</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">54340:S</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 03</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Aug</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2023</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 23:20:31.014</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Background</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> append</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> only</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> file</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rewriting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> started</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> by</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pid</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 54450</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">54340:S</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 03</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Aug</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2023</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 23:20:31.092</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> AOF</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rewrite</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> child</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> asks</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> stop</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sending</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> diffs.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">54450:C</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 03</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Aug</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2023</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 23:20:31.093</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Parent</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> agreed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> stop</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sending</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> diffs.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Finalizing</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> AOF...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">54450:C</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 03</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Aug</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2023</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 23:20:31.093</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Concatenating</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.00</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MB</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> AOF</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> diff</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> received</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> parent.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">54450:C</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 03</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Aug</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2023</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 23:20:31.093</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SYNC</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> append</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> only</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> file</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rewrite</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> performed</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">54450:C</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 03</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Aug</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2023</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 23:20:31.093</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> AOF</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rewrite:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 8</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MB</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> memory</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> used</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> by</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> copy-on-write</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">54340:S</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 03</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Aug</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2023</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 23:20:31.142</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Background</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> AOF</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rewrite</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> terminated</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> with</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> success</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">54340:S</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 03</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Aug</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2023</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 23:20:31.142</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Residual</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> parent</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> diff</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> successfully</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> flushed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rewritten</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> AOF</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">MB</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">54340:S</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 03</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Aug</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2023</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 23:20:31.142</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Background</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> AOF</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rewrite</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> finished</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> successfully</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># aof搞定之后，主从同步也正式完毕了</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 后续只要在主库的修改操作，都会实时同步到从库</span></span></code></pre></div><h2 id="replication相关其他问题" tabindex="-1">Replication相关其他问题 <a class="header-anchor" href="#replication相关其他问题" aria-label="Permalink to &quot;Replication相关其他问题&quot;">​</a></h2><h4 id="从库只读" tabindex="-1">从库只读 <a class="header-anchor" href="#从库只读" aria-label="Permalink to &quot;从库只读&quot;">​</a></h4><p>默认情况下，从机工作在只读模式下，即无法对从机执行写指令</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@cs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]# redis-cli get zhangkai1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;1&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@cs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]# redis-cli set k1 v1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">READONLY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> You</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> can&#39;t write against a read only replica.</span></span></code></pre></div><p>若要更改此模式，可在配置文件修改如下选项</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 默认是yes-只读，no-可写</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">slave-read-only</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> yes/no</span></span></code></pre></div><p><strong>但一般，我们从库不负责写入</strong></p><h4 id="过期key处理" tabindex="-1">过期key处理 <a class="header-anchor" href="#过期key处理" aria-label="Permalink to &quot;过期key处理&quot;">​</a></h4><p>Redis可以通过设置key的过期时间来限制key的生存时间，Redis处理key过期有惰性删除和定期删除两种机制，这一机制依赖Redis实例的计时能力。如果主机、从机同时启用key过期的处理机制，可能会导致一些问题。为此，Redis采取了三个技术手段来解决key过期的问题：</p><ul><li>从机禁用主动key过期机制。主机在执行key过期后，会以<code>DEL</code>指令的方式向所有从机传播指令，从而保证从机移除过期的key。</li><li>依赖主机的key过期机制是无法做到实时性的，所以针对读操作，从机将会按照自己的时钟向客户端返回key不存在。</li><li>为防止Lua脚本执行期间key过期，Lua脚本将会传播给从机执行。</li></ul><h4 id="心跳机制" tabindex="-1">心跳机制 <a class="header-anchor" href="#心跳机制" aria-label="Permalink to &quot;心跳机制&quot;">​</a></h4><p>在命令传播阶段，每隔一秒，slave节点向master节点发送一次心跳信息，命令格式为<code>REPLCONF ACK &lt;offset&gt;</code>。</p><p>命令中的offset是就是slave最新的复制偏移量，master接收后便会与自己的offset对比。如果从节点数据缺失，主节点会推送缺失的数据。</p><p><strong>不仅仅是Redis有，MySQL, MongoDB等都有</strong></p><h4 id="min-replica机制" tabindex="-1">min-replica机制 <a class="header-anchor" href="#min-replica机制" aria-label="Permalink to &quot;min-replica机制&quot;">​</a></h4><p>Redis主从复制不仅仅是解决主机、从机之间数据同步的问题，它还需要保证数据的安全性。这里的安全性主要是指主从之间数据同步达到一致的效率，以及主从结构下读写分离场景中分布式系统的可靠性。</p><p>Redis采用异步复制机制，它无法真正保证每个从机都能准确的收到传播的指令，所以主从之间必然会存在命令丢失的时间窗口。</p><p>为此，Redis引入了<code>min-replicas</code>选项，该机制在redis.conf中有两个配置项：</p><ul><li>min-replicas-to-write ：至少有N个从机才能写入数据。保证从机最低数量。</li><li>min-replicas-max-lag ：如果每个从机的延迟值大于N，则拒绝写入数据。保证主从同步延迟。</li></ul><p>通过<code>info replication</code>可以查看从机数量（connected_slaves）、每个从机的延迟值（lag）</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@cs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]# redis-cli INFO REPLICATION</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Replication</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">role:master</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">connected_slaves:2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">slave0:ip</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">=192.168.10.151,port=6379,state=online,offset=8453211,lag=0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">slave1:ip</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">=192.168.10.152,port=6379,state=online,offset=8453211,lag=1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">master_replid:1c2c8c97d3b3c4e4ba6fc1237b3742161f114cbc</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">master_replid2:0000000000000000000000000000000000000000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">master_repl_offset:8453211</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">second_repl_offset:-1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">repl_backlog_active:1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">repl_backlog_size:1048576</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">repl_backlog_first_byte_offset:7404636</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">repl_backlog_histlen:1048576</span></span></code></pre></div><p>这一机制是通过从机与主机之间心跳来实现的，如上文所讲，从机每隔一秒向主机发送一次心跳数据，基于心跳，主节点可以：</p><ul><li>更新从机同步确认时间：基于主节点时间及同步确认时间计算延迟值。</li><li>更新主从最后通信时间：用于从机通信超时检测，如果通信超时，主机会移除从机。</li></ul><h4 id="主库关闭持久化时的复制安全性" tabindex="-1">主库关闭持久化时的复制安全性 <a class="header-anchor" href="#主库关闭持久化时的复制安全性" aria-label="Permalink to &quot;主库关闭持久化时的复制安全性&quot;">​</a></h4><p>当master关闭了持久化时，如果发生故障后自动重启时，由本地没有保存持久化的数据，重启的Redis内存数据为空，而slave会自动同步master的数据，就会导致slave的数据也会被清空。</p><p>所以，我们应该尽可能为master节点开启持久化，这样可以防止Redis故障重启时数据丢失，进而导致slave数据被清除。如果确实无法开启持久化机制，那应该配置master节点无法自动重启，确保从机可以成为新的master节点，防止数据被清除。</p><h2 id="断开主从复制" tabindex="-1">断开主从复制 <a class="header-anchor" href="#断开主从复制" aria-label="Permalink to &quot;断开主从复制&quot;">​</a></h2><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">redis-cli</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SLAVEOF</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> no</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> one</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@cs opt]# redis-cli SLAVEOF no one</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">OK</span></span></code></pre></div><h2 id="主从复制注意事项" tabindex="-1">主从复制注意事项 <a class="header-anchor" href="#主从复制注意事项" aria-label="Permalink to &quot;主从复制注意事项&quot;">​</a></h2><ol><li>从节点只读不可写</li><li>从节点不会自动故障转移，他会⼀直尝试同步主节点，并且依然不可写</li><li>主从复制故障转移需要介入的地方 <ul><li>修改代码指向新主的IP</li><li>从节点需要执行slaveof no one</li></ul></li><li>从库建立同步时会清空自己的数据，如果同步对象写错了，就清空了</li><li>断开主从复制状态后，从库会自动变成主库</li><li>⼀定要做好数据备份，无论是主节点还是从节点，操作前最好做下备份</li></ol></div></div></main><footer class="VPDocFooter" data-v-39a288b8 data-v-d4a0bba5><!--[--><!--]--><!----><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-d4a0bba5><span class="visually-hidden" id="doc-footer-aria-label" data-v-d4a0bba5>Pager</span><div class="pager" data-v-d4a0bba5><a class="VPLink link pager-link prev" href="/redis/RedisDataType.html" data-v-d4a0bba5><!--[--><span class="desc" data-v-d4a0bba5>Previous page</span><span class="title" data-v-d4a0bba5>Redis数据类型</span><!--]--></a></div><div class="pager" data-v-d4a0bba5><!----></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-5d98c3a5 data-v-e315a0ad><div class="container" data-v-e315a0ad><p class="message" data-v-e315a0ad>部分内容网络所学，如有侵权可联系QQ:3127993395</p><p class="copyright" data-v-e315a0ad>苏ICP备2023051137号</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"django_django-auth.md\":\"B5qsNPl1\",\"django_modelclass.md\":\"D0V4GmYW\",\"django_index.md\":\"BiBI_uP3\",\"django_django-admin.md\":\"BKoL0ZqU\",\"django_djangomodel.md\":\"B6hNZHLj\",\"drf_index.md\":\"C_tKhTRc\",\"hadoop_index.md\":\"-U7ybsG-\",\"go_index.md\":\"qAEL7Dwb\",\"python_supplement_typeandobjectandclass.md\":\"3_kTKukP\",\"drf_auth-permission-throttle-version.md\":\"Clj1f0Gx\",\"django_djangomanage.md\":\"BOfkZR3V\",\"linux_nginx1.24.0(centos7).md\":\"CSfztF6q\",\"hadoop_hadoop-cluster.md\":\"BMiHCEnY\",\"linux_index.md\":\"C-8FDiiU\",\"redis_rediskey.md\":\"3nAMbCSm\",\"redis_pythonrediscluster.md\":\"CBwo4MpF\",\"gin_gin-router.md\":\"DM7sQ2I2\",\"redis_redispersistence.md\":\"JIPrsT2Z\",\"python_supplement_isand__.md\":\"AJseDmRw\",\"python_supplement_isinstanceandtype.md\":\"Bsvbizc7\",\"hadoop_hadoop3.3.5(win11)-install.md\":\"eW8jMnom\",\"python_concurrentprogramming_index.md\":\"BgwpZHnD\",\"python_supplement_bisect.md\":\"j5v_aJSt\",\"python_supplement_cookie-session.md\":\"De0Rqjku\",\"redis_pythonredissentinel.md\":\"CGHn6jma\",\"linux_mysql8.0(centos7).md\":\"BoJ0nvxa\",\"git_gituseful.md\":\"CY4Bz3Ig\",\"redis_index.md\":\"B65sfYS0\",\"python_supplement_builtintypes.md\":\"CepjDg59\",\"redis_no-password.md\":\"C3rFIYmi\",\"index.md\":\"Bo5HhdHQ\",\"redis_django-redis.md\":\"8UxFilWd\",\"hadoop_hadoop3.3.5(centos7)-install.md\":\"CKaIBWv6\",\"python_index.md\":\"D_X1BmpG\",\"linux_redis5.0.7(centos7).md\":\"BNffXwt1\",\"python_supplement_index.md\":\"ZuiyZwRC\",\"linux_projectpreparation.md\":\"CCkgCg6V\",\"git_index.md\":\"DCqlJlZ0\",\"django_django-signal.md\":\"DhiSY98e\",\"vue_index.md\":\"DRI1MKzY\",\"linux_python3.11.0(centos7).md\":\"sDOd0ldk\",\"vue_pinia.md\":\"DuzRA7mk\",\"drf_response-transaction-logging.md\":\"CYwshb67\",\"vue_cookie.md\":\"CUm6HIKz\",\"python_supplement_jwt.md\":\"BthgVDSr\",\"redis_redissentinel.md\":\"Cd1cHVN3\",\"redis_redismaster-slavereplication.md\":\"BepGyD_Q\",\"django_djangoadmin.md\":\"CiSJaOhe\",\"gin_index.md\":\"CVIcXuwd\",\"python_objectoriented_index.md\":\"CbLnZnak\",\"python_supplement_socket.md\":\"ndU6TUCe\",\"django_modelmanager.md\":\"D1nSOeco\",\"vue_router.md\":\"DXCuypyy\",\"vue_axios.md\":\"CCsYn0vk\",\"python_supplement_type.md\":\"CMYOsZAA\",\"linux_projectdeployment.md\":\"CnzxUmkq\",\"redis_redisdatatype.md\":\"CUrRbeQO\",\"python_concurrentprogramming_processing.md\":\"BI_ZZhT8\",\"linux_resolveerror.md\":\"B3xfXnyV\",\"python_objectoriented_member.md\":\"CEo0SFb8\",\"vue_notes.md\":\"BsurLIzm\",\"drf_parser-serializer-pagination.md\":\"BwpC70-C\",\"redis_python-redis.md\":\"CIXfKIvP\",\"python_concurrentprogramming_threading.md\":\"9OCVmfVh\",\"python_objectoriented_self-encapsulation-inherit-polymorphism.md\":\"CZ76bGKM\",\"python_supplement_magicfunction.md\":\"CS5tGD4j\",\"python_objectoriented_function-error-reflection.md\":\"u9j7ZjS1\",\"drf_views-url-filter.md\":\"CuxaLpKT\",\"redis_rediscluster.md\":\"C0XUkPGl\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"BetterWilson Notes\",\"description\":\"Notes from BetterWilson\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"search\":{\"provider\":\"local\"},\"siteTitle\":\"BetterWilson Notes\",\"logo\":\"logo.png\",\"head\":[[\"link\",{\"rel\":\"icon\",\"href\":\"/logo.png\"}]],\"nav\":[{\"text\":\"Python\",\"items\":[{\"text\":\"python并发编程\",\"link\":\"/python/ConcurrentProgramming/\"},{\"text\":\"python面向对象\",\"link\":\"/python/ObjectOriented/\"},{\"text\":\"python补充\",\"link\":\"/python/supplement/\"}]},{\"text\":\"Git\",\"link\":\"/git/\"},{\"text\":\"Django\",\"link\":\"/django/\"},{\"text\":\"DRF\",\"link\":\"/drf/\"},{\"text\":\"Gin\",\"link\":\"/gin/\"},{\"text\":\"Vue\",\"link\":\"/vue/\"},{\"text\":\"Redis\",\"link\":\"/redis/\"},{\"text\":\"Linux\",\"link\":\"/linux/\"},{\"text\":\"hadoop\",\"link\":\"/hadoop/\"}],\"sidebar\":{\"/python/ConcurrentProgramming/\":{\"text\":\"python并发编程\",\"items\":[{\"text\":\"进程\",\"link\":\"/python/ConcurrentProgramming/processing\"},{\"text\":\"线程\",\"link\":\"/python/ConcurrentProgramming/threading\"}]},\"/python/ObjectOriented/\":{\"text\":\"python面向对象\",\"items\":[{\"text\":\"成员，成员修饰符\",\"link\":\"/python/ObjectOriented/member\"},{\"text\":\"内置函数，异常，反射\",\"link\":\"/python/ObjectOriented/function-error-reflection\"},{\"text\":\"self对象，封装，继承，多态\",\"link\":\"/python/ObjectOriented/self-encapsulation-inherit-polymorphism\"}]},\"/python/supplement/\":{\"text\":\"python补充\",\"items\":[{\"text\":\"魔法函数\",\"link\":\"/python/supplement/MagicFunction\"},{\"text\":\"bisect模块\",\"link\":\"/python/supplement/bisect\"},{\"text\":\"isinstance和type区别\",\"link\":\"/python/supplement/IsinstanceAndType\"},{\"text\":\"is和==的关系\",\"link\":\"/python/supplement/IsAnd==\"},{\"text\":\"python中的常见内置类型分类\",\"link\":\"/python/supplement/BuiltInTypes\"},{\"text\":\"type,object,class三者关系\",\"link\":\"/python/supplement/TypeAndObjectAndClass\"},{\"text\":\"type元类\",\"link\":\"/python/supplement/type\"},{\"text\":\"socket模块\",\"link\":\"/python/supplement/socket\"},{\"text\":\"cookie,session缓存\",\"link\":\"/python/supplement/cookie-session\"},{\"text\":\"JWT\",\"link\":\"/python/supplement/jwt\"}]},\"/git\":{\"text\":\"Git\",\"items\":[{\"text\":\"Git常用命令清单\",\"link\":\"/git/GitUseful\"}]},\"/drf\":{\"text\":\"DRF\",\"items\":[{\"text\":\"drf返回值，事务，Logging日志\",\"link\":\"/drf/response-transaction-logging\"},{\"text\":\"drf解析器，序列化器，分页\",\"link\":\"/drf/parser-serializer-pagination\"},{\"text\":\"drf认证，权限，限流，版本\",\"link\":\"/drf/auth-permission-throttle-version\"},{\"text\":\"drf视图，路由，筛选器\",\"link\":\"/drf/views-url-filter\"}]},\"/django\":{\"text\":\"Django\",\"items\":[{\"text\":\"Django-admin单例模式和懒加载\",\"link\":\"/django/Django-admin\"},{\"text\":\"Django-admin组件\",\"link\":\"/django/DjangoAdmin\"},{\"text\":\"Django-auth组件\",\"link\":\"/django/Django-auth\"},{\"text\":\"Django-signal组件\",\"link\":\"/django/Django-signal\"},{\"text\":\"Django模板查找顺序\",\"link\":\"/django/DjangoModel\"},{\"text\":\"Django自定义命令\",\"link\":\"/django/DjangoManage\"},{\"text\":\"model中的抽象类\",\"link\":\"/django/modelClass\"},{\"text\":\"model中的Manager对象\",\"link\":\"/django/modelManager\"}]},\"/redis\":{\"text\":\"Redis\",\"items\":[{\"text\":\"多台服务器无密码传输数据\",\"link\":\"/redis/no-password\"},{\"text\":\"Django连接redis\",\"link\":\"/redis/Django-redis\"},{\"text\":\"Python连接redis\",\"link\":\"/redis/Python-redis\"},{\"text\":\"Python连接Redis集群\",\"link\":\"/redis/PythonRedisCluster\"},{\"text\":\"Python连接Redis哨兵\",\"link\":\"/redis/PythonRedisSentinel\"},{\"text\":\"redis持久化\",\"link\":\"/redis/redisPersistence\"},{\"text\":\"Redis大key热key过期key\",\"link\":\"/redis/RedisKey\"},{\"text\":\"Redis集群Cluster\",\"link\":\"/redis/RedisCluster\"},{\"text\":\"Redis哨兵Sentinel\",\"link\":\"/redis/RedisSentinel\"},{\"text\":\"Redis数据类型\",\"link\":\"/redis/RedisDataType\"},{\"text\":\"Redis主从复制\",\"link\":\"/redis/RedisMaster-slaveReplication\"}]},\"/linux\":{\"text\":\"linux\",\"items\":[{\"text\":\"项目准备\",\"link\":\"/linux/ProjectPreparation\"},{\"text\":\"MySQL8.0安装(centos7)\",\"link\":\"/linux/mysql8.0(centos7)\"},{\"text\":\"nginx1.24.0安装(centos7)\",\"link\":\"/linux/nginx1.24.0(centos7)\"},{\"text\":\"Python3.11.0解释器安装(centos7)\",\"link\":\"/linux/python3.11.0(centos7)\"},{\"text\":\"Redis5.0.7安装(centos7)\",\"link\":\"/linux/redis5.0.7(centos7)\"},{\"text\":\"报错解决\",\"link\":\"/linux/ResolveError\"},{\"text\":\"项目部署\",\"link\":\"/linux/ProjectDeployment\"}]},\"/hadoop\":{\"text\":\"hadoop\",\"items\":[{\"text\":\"Hadoop3.3.5(win11)安装\",\"link\":\"/hadoop/hadoop3.3.5(win11)-install\"},{\"text\":\"Hadoop3.3.5(centos7)安装\",\"link\":\"/hadoop/hadoop3.3.5(centos7)-install\"},{\"text\":\"Hadoop集群\",\"link\":\"/hadoop/hadoop-cluster\"}]},\"/vue\":{\"text\":\"Vue\",\"items\":[{\"text\":\"vue知识点\",\"link\":\"/vue/notes\"},{\"text\":\"vue-router\",\"link\":\"/vue/router\"},{\"text\":\"vue-pinia\",\"link\":\"/vue/pinia\"},{\"text\":\"vue-axios\",\"link\":\"/vue/axios\"},{\"text\":\"vue-cookie\",\"link\":\"/vue/cookie\"}]},\"/gin\":{\"text\":\"Gin\",\"items\":[{\"text\":\"gin路由框架\",\"link\":\"/gin/gin-router\"}]}},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/3127993395/Notes\"}],\"footer\":{\"message\":\"部分内容网络所学，如有侵权可联系QQ:3127993395\",\"copyright\":\"苏ICP备2023051137号\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>